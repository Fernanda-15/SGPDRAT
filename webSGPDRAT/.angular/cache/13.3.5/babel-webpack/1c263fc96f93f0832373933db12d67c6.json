{"ast":null,"code":"\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.processRows = exports.ClearTasks = exports.RemoveTaskItem = exports.AddTaskItemObject = exports.AddTaskItem = exports.createTaskInfo = exports.TaskItem = exports.TaskItemObject = exports.sortTasks = exports.taskLink = void 0;\n\nvar general_utils_1 = require(\"./utils/general_utils\");\n\nvar draw_utils_1 = require(\"./utils/draw_utils\");\n\nvar date_utils_1 = require(\"./utils/date_utils\"); // function to open window to display task link\n\n\nexports.taskLink = function (pRef, pWidth, pHeight) {\n  var vWidth, vHeight;\n  if (pWidth) vWidth = pWidth;else vWidth = 400;\n  if (pHeight) vHeight = pHeight;else vHeight = 400;\n  window.open(pRef, 'newwin', 'height=' + vHeight + ',width=' + vWidth); // let OpenWindow = \n};\n\nexports.sortTasks = function (pList, pID, pIdx) {\n  if (pList.length < 2) {\n    return pIdx;\n  }\n\n  var sortIdx = pIdx;\n  var sortArr = new Array();\n\n  for (var i = 0; i < pList.length; i++) {\n    if (pList[i].getParent() == pID) sortArr.push(pList[i]);\n  }\n\n  if (sortArr.length > 0) {\n    sortArr.sort(function (a, b) {\n      var i = a.getStart().getTime() - b.getStart().getTime();\n      if (i == 0) i = a.getEnd().getTime() - b.getEnd().getTime();\n      if (i == 0) return a.getID() - b.getID();else return i;\n    });\n  }\n\n  for (var j = 0; j < sortArr.length; j++) {\n    for (var i = 0; i < pList.length; i++) {\n      if (pList[i].getID() == sortArr[j].getID()) {\n        pList[i].setSortIdx(sortIdx++);\n        sortIdx = exports.sortTasks(pList, pList[i].getID(), sortIdx);\n      }\n    }\n  }\n\n  return sortIdx;\n};\n\nexports.TaskItemObject = function (object) {\n  var pDataObject = __assign({}, object);\n\n  general_utils_1.internalProperties.forEach(function (property) {\n    delete pDataObject[property];\n  });\n  return new exports.TaskItem(object.pID, object.pName, object.pStart, object.pEnd, object.pClass, object.pLink, object.pMile, object.pRes, object.pComp, object.pGroup, object.pParent, object.pOpen, object.pDepend, object.pCaption, object.pNotes, object.pGantt, object.pCost, object.pPlanStart, object.pPlanEnd, object.pDuration, object.pBarText, object, object.pPlanClass);\n};\n\nexports.TaskItem = function (pID, pName, pStart, pEnd, pClass, pLink, pMile, pRes, pComp, pGroup, pParent, pOpen, pDepend, pCaption, pNotes, pGantt, pCost, pPlanStart, pPlanEnd, pDuration, pBarText, pDataObject, pPlanClass) {\n  if (pCost === void 0) {\n    pCost = null;\n  }\n\n  if (pPlanStart === void 0) {\n    pPlanStart = null;\n  }\n\n  if (pPlanEnd === void 0) {\n    pPlanEnd = null;\n  }\n\n  if (pDuration === void 0) {\n    pDuration = null;\n  }\n\n  if (pBarText === void 0) {\n    pBarText = null;\n  }\n\n  if (pDataObject === void 0) {\n    pDataObject = null;\n  }\n\n  if (pPlanClass === void 0) {\n    pPlanClass = null;\n  }\n\n  var vGantt = pGantt ? pGantt : this;\n  var _id = document.createTextNode(pID).data;\n  var vID = general_utils_1.hashKey(document.createTextNode(pID).data);\n  var vName = document.createTextNode(pName).data;\n  var vStart = null;\n  var vEnd = null;\n  var vPlanStart = null;\n  var vPlanEnd = null;\n  var vGroupMinStart = null;\n  var vGroupMinEnd = null;\n  var vGroupMinPlanStart = null;\n  var vGroupMinPlanEnd = null;\n  var vClass = document.createTextNode(pClass).data;\n  var vPlanClass = document.createTextNode(pPlanClass).data;\n  var vLink = document.createTextNode(pLink).data;\n  var vMile = parseInt(document.createTextNode(pMile).data);\n  var vRes = document.createTextNode(pRes).data;\n  var vComp = parseFloat(document.createTextNode(pComp).data);\n  var vCost = parseInt(document.createTextNode(pCost).data);\n  var vGroup = parseInt(document.createTextNode(pGroup).data);\n  var vDataObject = pDataObject;\n  var vCompVal;\n  var parent = document.createTextNode(pParent).data;\n\n  if (parent && parent !== '0') {\n    parent = general_utils_1.hashKey(parent).toString();\n  }\n\n  var vParent = parent;\n  var vOpen = vGroup == 2 ? 1 : parseInt(document.createTextNode(pOpen).data);\n  var vDepend = new Array();\n  var vDependType = new Array();\n  var vCaption = document.createTextNode(pCaption).data;\n  var vDuration = pDuration || '';\n  var vBarText = pBarText || '';\n  var vLevel = 0;\n  var vNumKid = 0;\n  var vWeight = 0;\n  var vVisible = 1;\n  var vSortIdx = 0;\n  var vToDelete = false;\n  var x1, y1, x2, y2;\n  var vNotes;\n  var vParItem = null;\n  var vCellDiv = null;\n  var vBarDiv = null;\n  var vTaskDiv = null;\n  var vPlanTaskDiv = null;\n  var vListChildRow = null;\n  var vChildRow = null;\n  var vGroupSpan = null;\n  vNotes = document.createElement('span');\n  vNotes.className = 'gTaskNotes';\n\n  if (pNotes != null) {\n    vNotes.innerHTML = pNotes;\n    general_utils_1.stripUnwanted(vNotes);\n  }\n\n  if (pStart != null && pStart != '') {\n    vStart = pStart instanceof Date ? pStart : date_utils_1.parseDateStr(document.createTextNode(pStart).data, vGantt.getDateInputFormat());\n    vGroupMinStart = vStart;\n  }\n\n  if (pEnd != null && pEnd != '') {\n    vEnd = pEnd instanceof Date ? pEnd : date_utils_1.parseDateStr(document.createTextNode(pEnd).data, vGantt.getDateInputFormat());\n    vGroupMinEnd = vEnd;\n  }\n\n  if (pPlanStart != null && pPlanStart != '') {\n    vPlanStart = pPlanStart instanceof Date ? pPlanStart : date_utils_1.parseDateStr(document.createTextNode(pPlanStart).data, vGantt.getDateInputFormat());\n    vGroupMinPlanStart = vPlanStart;\n  }\n\n  if (pPlanEnd != null && pPlanEnd != '') {\n    vPlanEnd = pPlanEnd instanceof Date ? pPlanEnd : date_utils_1.parseDateStr(document.createTextNode(pPlanEnd).data, vGantt.getDateInputFormat());\n    vGroupMinPlanEnd = vPlanEnd;\n  }\n\n  if (pDepend != null) {\n    var vDependStr = pDepend + '';\n    var vDepList = vDependStr.split(',');\n    var n = vDepList.length;\n\n    for (var k = 0; k < n; k++) {\n      if (vDepList[k].toUpperCase().endsWith('SS')) {\n        vDepend[k] = vDepList[k].substring(0, vDepList[k].length - 2);\n        vDependType[k] = 'SS';\n      } else if (vDepList[k].toUpperCase().endsWith('FF')) {\n        vDepend[k] = vDepList[k].substring(0, vDepList[k].length - 2);\n        vDependType[k] = 'FF';\n      } else if (vDepList[k].toUpperCase().endsWith('SF')) {\n        vDepend[k] = vDepList[k].substring(0, vDepList[k].length - 2);\n        vDependType[k] = 'SF';\n      } else if (vDepList[k].toUpperCase().endsWith('FS')) {\n        vDepend[k] = vDepList[k].substring(0, vDepList[k].length - 2);\n        vDependType[k] = 'FS';\n      } else {\n        vDepend[k] = vDepList[k];\n        vDependType[k] = 'FS';\n      }\n\n      if (vDepend[k]) {\n        vDepend[k] = general_utils_1.hashKey(vDepend[k]).toString();\n      }\n    }\n  }\n\n  this.getID = function () {\n    return vID;\n  };\n\n  this.getOriginalID = function () {\n    return _id;\n  };\n\n  this.getGantt = function () {\n    return vGantt;\n  };\n\n  this.getName = function () {\n    return vName;\n  };\n\n  this.getStart = function () {\n    if (vStart) return vStart;else if (vPlanStart) return vPlanStart;else return new Date();\n  };\n\n  this.getStartVar = function () {\n    return vStart;\n  };\n\n  this.getEnd = function () {\n    if (vEnd) return vEnd;else if (vPlanEnd) return vPlanEnd;else if (vStart && vDuration) {\n      var date = new Date(vStart);\n      var vUnits = vDuration.split(' ');\n      var value = parseInt(vUnits[0]);\n\n      switch (vUnits[1]) {\n        case 'hour':\n          date.setMinutes(date.getMinutes() + value * 60);\n          break;\n\n        case 'day':\n          date.setMinutes(date.getMinutes() + value * 60 * 24);\n          break;\n\n        case 'week':\n          date.setMinutes(date.getMinutes() + value * 60 * 24 * 7);\n          break;\n\n        case 'month':\n          date.setMonth(date.getMonth() + value);\n          break;\n\n        case 'quarter':\n          date.setMonth(date.getMonth() + value * 3);\n          break;\n      }\n\n      return date;\n    } else return new Date();\n  };\n\n  this.getEndVar = function () {\n    return vEnd;\n  };\n\n  this.getPlanStart = function () {\n    return vPlanStart ? vPlanStart : vStart;\n  };\n\n  this.getPlanClass = function () {\n    return vPlanClass && vPlanClass !== \"null\" ? vPlanClass : vClass;\n  };\n\n  this.getPlanEnd = function () {\n    return vPlanEnd ? vPlanEnd : vEnd;\n  };\n\n  this.getCost = function () {\n    return vCost;\n  };\n\n  this.getGroupMinStart = function () {\n    return vGroupMinStart;\n  };\n\n  this.getGroupMinEnd = function () {\n    return vGroupMinEnd;\n  };\n\n  this.getGroupMinPlanStart = function () {\n    return vGroupMinPlanStart;\n  };\n\n  this.getGroupMinPlanEnd = function () {\n    return vGroupMinPlanEnd;\n  };\n\n  this.getClass = function () {\n    return vClass;\n  };\n\n  this.getLink = function () {\n    return vLink;\n  };\n\n  this.getMile = function () {\n    return vMile;\n  };\n\n  this.getDepend = function () {\n    if (vDepend) return vDepend;else return null;\n  };\n\n  this.getDataObject = function () {\n    return vDataObject;\n  };\n\n  this.getDepType = function () {\n    if (vDependType) return vDependType;else return null;\n  };\n\n  this.getCaption = function () {\n    if (vCaption) return vCaption;else return '';\n  };\n\n  this.getResource = function () {\n    if (vRes) return vRes;else return '\\u00A0';\n  };\n\n  this.getCompVal = function () {\n    if (vComp) return vComp;else if (vCompVal) return vCompVal;else return 0;\n  };\n\n  this.getCompStr = function () {\n    if (vComp) return vComp + '%';else if (vCompVal) return vCompVal + '%';else return '';\n  };\n\n  this.getCompRestStr = function () {\n    if (vComp) return 100 - vComp + '%';else if (vCompVal) return 100 - vCompVal + '%';else return '';\n  };\n\n  this.getNotes = function () {\n    return vNotes;\n  };\n\n  this.getSortIdx = function () {\n    return vSortIdx;\n  };\n\n  this.getToDelete = function () {\n    return vToDelete;\n  };\n\n  this.getDuration = function (pFormat, pLang) {\n    if (vMile) {\n      vDuration = '-';\n    } else if (!vEnd && !vStart && vPlanStart && vPlanEnd) {\n      return calculateVDuration(pFormat, pLang, this.getPlanStart(), this.getPlanEnd());\n    } else if (!vEnd && vDuration) {\n      return vDuration;\n    } else {\n      vDuration = calculateVDuration(pFormat, pLang, this.getStart(), this.getEnd());\n    }\n\n    return vDuration;\n  };\n\n  function calculateVDuration(pFormat, pLang, start, end) {\n    var vDuration;\n    var vUnits = null;\n\n    switch (pFormat) {\n      case 'week':\n        vUnits = 'day';\n        break;\n\n      case 'month':\n        vUnits = 'week';\n        break;\n\n      case 'quarter':\n        vUnits = 'month';\n        break;\n\n      default:\n        vUnits = pFormat;\n        break;\n    } // let vTaskEnd = new Date(this.getEnd().getTime());\n    // if ((vTaskEnd.getTime() - (vTaskEnd.getTimezoneOffset() * 60000)) % (86400000) == 0) {\n    //   vTaskEnd = new Date(vTaskEnd.getFullYear(), vTaskEnd.getMonth(), vTaskEnd.getDate() + 1, vTaskEnd.getHours(), vTaskEnd.getMinutes(), vTaskEnd.getSeconds());\n    // }\n    // let tmpPer = (getOffset(this.getStart(), vTaskEnd, 999, vUnits)) / 1000;\n\n\n    var hours = (end.getTime() - start.getTime()) / 1000 / 60 / 60;\n    var tmpPer;\n\n    switch (vUnits) {\n      case 'hour':\n        tmpPer = Math.round(hours);\n        vDuration = tmpPer + ' ' + (tmpPer != 1 ? pLang['hrs'] : pLang['hr']);\n        break;\n\n      case 'day':\n        tmpPer = Math.round(hours / 24);\n        vDuration = tmpPer + ' ' + (tmpPer != 1 ? pLang['dys'] : pLang['dy']);\n        break;\n\n      case 'week':\n        tmpPer = Math.round(hours / 24 / 7);\n        vDuration = tmpPer + ' ' + (tmpPer != 1 ? pLang['wks'] : pLang['wk']);\n        break;\n\n      case 'month':\n        tmpPer = Math.round(hours / 24 / 7 / 4.35);\n        vDuration = tmpPer + ' ' + (tmpPer != 1 ? pLang['mths'] : pLang['mth']);\n        break;\n\n      case 'quarter':\n        tmpPer = Math.round(hours / 24 / 7 / 13);\n        vDuration = tmpPer + ' ' + (tmpPer != 1 ? pLang['qtrs'] : pLang['qtr']);\n        break;\n    }\n\n    return vDuration;\n  }\n\n  this.getBarText = function () {\n    return vBarText;\n  };\n\n  this.getParent = function () {\n    return vParent;\n  };\n\n  this.getGroup = function () {\n    return vGroup;\n  };\n\n  this.getOpen = function () {\n    return vOpen;\n  };\n\n  this.getLevel = function () {\n    return vLevel;\n  };\n\n  this.getNumKids = function () {\n    return vNumKid;\n  };\n\n  this.getWeight = function () {\n    return vWeight;\n  };\n\n  this.getStartX = function () {\n    return x1;\n  };\n\n  this.getStartY = function () {\n    return y1;\n  };\n\n  this.getEndX = function () {\n    return x2;\n  };\n\n  this.getEndY = function () {\n    return y2;\n  };\n\n  this.getVisible = function () {\n    return vVisible;\n  };\n\n  this.getParItem = function () {\n    return vParItem;\n  };\n\n  this.getCellDiv = function () {\n    return vCellDiv;\n  };\n\n  this.getBarDiv = function () {\n    return vBarDiv;\n  };\n\n  this.getTaskDiv = function () {\n    return vTaskDiv;\n  };\n\n  this.getPlanTaskDiv = function () {\n    return vPlanTaskDiv;\n  };\n\n  this.getChildRow = function () {\n    return vChildRow;\n  };\n\n  this.getListChildRow = function () {\n    return vListChildRow;\n  };\n\n  this.getGroupSpan = function () {\n    return vGroupSpan;\n  };\n\n  this.setName = function (pName) {\n    vName = pName;\n  };\n\n  this.setNotes = function (pNotes) {\n    vNotes = pNotes;\n  };\n\n  this.setClass = function (pClass) {\n    vClass = pClass;\n  };\n\n  this.setPlanClass = function (pPlanClass) {\n    vPlanClass = pPlanClass;\n  };\n\n  this.setCost = function (pCost) {\n    vCost = pCost;\n  };\n\n  this.setResource = function (pRes) {\n    vRes = pRes;\n  };\n\n  this.setDuration = function (pDuration) {\n    vDuration = pDuration;\n  };\n\n  this.setDataObject = function (pDataObject) {\n    vDataObject = pDataObject;\n  };\n\n  this.setStart = function (pStart) {\n    if (pStart instanceof Date) {\n      vStart = pStart;\n    } else {\n      var temp = new Date(pStart);\n\n      if (temp instanceof Date && !isNaN(temp.valueOf())) {\n        vStart = temp;\n      }\n    }\n  };\n\n  this.setEnd = function (pEnd) {\n    if (pEnd instanceof Date) {\n      vEnd = pEnd;\n    } else {\n      var temp = new Date(pEnd);\n\n      if (temp instanceof Date && !isNaN(temp.valueOf())) {\n        vEnd = temp;\n      }\n    }\n  };\n\n  this.setPlanStart = function (pPlanStart) {\n    if (pPlanStart instanceof Date) vPlanStart = pPlanStart;else vPlanStart = new Date(pPlanStart);\n  };\n\n  this.setPlanEnd = function (pPlanEnd) {\n    if (pPlanEnd instanceof Date) vPlanEnd = pPlanEnd;else vPlanEnd = new Date(pPlanEnd);\n  };\n\n  this.setGroupMinStart = function (pStart) {\n    if (pStart instanceof Date) vGroupMinStart = pStart;\n  };\n\n  this.setGroupMinEnd = function (pEnd) {\n    if (pEnd instanceof Date) vGroupMinEnd = pEnd;\n  };\n\n  this.setLevel = function (pLevel) {\n    vLevel = parseInt(document.createTextNode(pLevel).data);\n  };\n\n  this.setNumKid = function (pNumKid) {\n    vNumKid = parseInt(document.createTextNode(pNumKid).data);\n  };\n\n  this.setWeight = function (pWeight) {\n    vWeight = parseInt(document.createTextNode(pWeight).data);\n  };\n\n  this.setCompVal = function (pCompVal) {\n    vCompVal = parseFloat(document.createTextNode(pCompVal).data);\n  };\n\n  this.setComp = function (pComp) {\n    vComp = parseInt(document.createTextNode(pComp).data);\n  };\n\n  this.setStartX = function (pX) {\n    x1 = parseInt(document.createTextNode(pX).data);\n  };\n\n  this.setStartY = function (pY) {\n    y1 = parseInt(document.createTextNode(pY).data);\n  };\n\n  this.setEndX = function (pX) {\n    x2 = parseInt(document.createTextNode(pX).data);\n  };\n\n  this.setEndY = function (pY) {\n    y2 = parseInt(document.createTextNode(pY).data);\n  };\n\n  this.setOpen = function (pOpen) {\n    vOpen = parseInt(document.createTextNode(pOpen).data);\n  };\n\n  this.setVisible = function (pVisible) {\n    vVisible = parseInt(document.createTextNode(pVisible).data);\n  };\n\n  this.setSortIdx = function (pSortIdx) {\n    vSortIdx = parseInt(document.createTextNode(pSortIdx).data);\n  };\n\n  this.setToDelete = function (pToDelete) {\n    if (pToDelete) vToDelete = true;else vToDelete = false;\n  };\n\n  this.setParItem = function (pParItem) {\n    if (pParItem) vParItem = pParItem;\n  };\n\n  this.setCellDiv = function (pCellDiv) {\n    if (typeof HTMLDivElement !== 'function' || pCellDiv instanceof HTMLDivElement) vCellDiv = pCellDiv;\n  }; //\"typeof HTMLDivElement !== 'function'\" to play nice with ie6 and 7\n\n\n  this.setGroup = function (pGroup) {\n    if (pGroup === true || pGroup === 'true') {\n      vGroup = 1;\n    } else if (pGroup === false || pGroup === 'false') {\n      vGroup = 0;\n    } else {\n      vGroup = parseInt(document.createTextNode(pGroup).data);\n    }\n  };\n\n  this.setBarText = function (pBarText) {\n    if (pBarText) vBarText = pBarText;\n  };\n\n  this.setBarDiv = function (pDiv) {\n    if (typeof HTMLDivElement !== 'function' || pDiv instanceof HTMLDivElement) vBarDiv = pDiv;\n  };\n\n  this.setTaskDiv = function (pDiv) {\n    if (typeof HTMLDivElement !== 'function' || pDiv instanceof HTMLDivElement) vTaskDiv = pDiv;\n  };\n\n  this.setPlanTaskDiv = function (pDiv) {\n    if (typeof HTMLDivElement !== 'function' || pDiv instanceof HTMLDivElement) vPlanTaskDiv = pDiv;\n  };\n\n  this.setChildRow = function (pRow) {\n    if (typeof HTMLTableRowElement !== 'function' || pRow instanceof HTMLTableRowElement) vChildRow = pRow;\n  };\n\n  this.setListChildRow = function (pRow) {\n    if (typeof HTMLTableRowElement !== 'function' || pRow instanceof HTMLTableRowElement) vListChildRow = pRow;\n  };\n\n  this.setGroupSpan = function (pSpan) {\n    if (typeof HTMLSpanElement !== 'function' || pSpan instanceof HTMLSpanElement) vGroupSpan = pSpan;\n  };\n\n  this.getAllData = function () {\n    return {\n      pID: vID,\n      pName: vName,\n      pStart: vStart,\n      pEnd: vEnd,\n      pPlanStart: vPlanStart,\n      pPlanEnd: vPlanEnd,\n      pGroupMinStart: vGroupMinStart,\n      pGroupMinEnd: vGroupMinEnd,\n      pClass: vClass,\n      pLink: vLink,\n      pMile: vMile,\n      pRes: vRes,\n      pComp: vComp,\n      pCost: vCost,\n      pGroup: vGroup,\n      pDataObject: vDataObject,\n      pPlanClass: vPlanClass\n    };\n  };\n};\n/**\r\n * @param pTask\r\n * @param templateStrOrFn template string or function(task). In any case parameters in template string are substituted.\r\n *        If string - just a static template.\r\n *        If function(task): string - per task template. Can return null|undefined to fallback to default template.\r\n *        If function(task): Promise<string>) - async per task template. Tooltip will show 'Loading...' if promise is not yet complete.\r\n *          Otherwise returned template will be handled in the same manner as in other cases.\r\n */\n\n\nexports.createTaskInfo = function (pTask, templateStrOrFn) {\n  var _this = this;\n\n  if (templateStrOrFn === void 0) {\n    templateStrOrFn = null;\n  }\n\n  var vTmpDiv;\n  var vTaskInfoBox = document.createDocumentFragment();\n  var vTaskInfo = draw_utils_1.newNode(vTaskInfoBox, 'div', null, 'gTaskInfo');\n\n  var setupTemplate = function (template) {\n    vTaskInfo.innerHTML = \"\";\n\n    if (template) {\n      var allData_1 = pTask.getAllData();\n      general_utils_1.internalProperties.forEach(function (key) {\n        var lang;\n\n        if (general_utils_1.internalPropertiesLang[key]) {\n          lang = _this.vLangs[_this.vLang][general_utils_1.internalPropertiesLang[key]];\n        }\n\n        if (!lang) {\n          lang = key;\n        }\n\n        var val = allData_1[key];\n        template = template.replace(\"{{\" + key + \"}}\", val);\n\n        if (lang) {\n          template = template.replace(\"{{Lang:\" + key + \"}}\", lang);\n        } else {\n          template = template.replace(\"{{Lang:\" + key + \"}}\", key);\n        }\n      });\n      draw_utils_1.newNode(vTaskInfo, 'span', null, 'gTtTemplate', template);\n    } else {\n      draw_utils_1.newNode(vTaskInfo, 'span', null, 'gTtTitle', pTask.getName());\n\n      if (_this.vShowTaskInfoStartDate == 1) {\n        vTmpDiv = draw_utils_1.newNode(vTaskInfo, 'div', null, 'gTILine gTIsd');\n        draw_utils_1.newNode(vTmpDiv, 'span', null, 'gTaskLabel', _this.vLangs[_this.vLang]['startdate'] + ': ');\n        draw_utils_1.newNode(vTmpDiv, 'span', null, 'gTaskText', date_utils_1.formatDateStr(pTask.getStart(), _this.vDateTaskDisplayFormat, _this.vLangs[_this.vLang]));\n      }\n\n      if (_this.vShowTaskInfoEndDate == 1) {\n        vTmpDiv = draw_utils_1.newNode(vTaskInfo, 'div', null, 'gTILine gTIed');\n        draw_utils_1.newNode(vTmpDiv, 'span', null, 'gTaskLabel', _this.vLangs[_this.vLang]['enddate'] + ': ');\n        draw_utils_1.newNode(vTmpDiv, 'span', null, 'gTaskText', date_utils_1.formatDateStr(pTask.getEnd(), _this.vDateTaskDisplayFormat, _this.vLangs[_this.vLang]));\n      }\n\n      if (_this.vShowTaskInfoDur == 1 && !pTask.getMile()) {\n        vTmpDiv = draw_utils_1.newNode(vTaskInfo, 'div', null, 'gTILine gTId');\n        draw_utils_1.newNode(vTmpDiv, 'span', null, 'gTaskLabel', _this.vLangs[_this.vLang]['dur'] + ': ');\n        draw_utils_1.newNode(vTmpDiv, 'span', null, 'gTaskText', pTask.getDuration(_this.vFormat, _this.vLangs[_this.vLang]));\n      }\n\n      if (_this.vShowTaskInfoComp == 1) {\n        vTmpDiv = draw_utils_1.newNode(vTaskInfo, 'div', null, 'gTILine gTIc');\n        draw_utils_1.newNode(vTmpDiv, 'span', null, 'gTaskLabel', _this.vLangs[_this.vLang]['completion'] + ': ');\n        draw_utils_1.newNode(vTmpDiv, 'span', null, 'gTaskText', pTask.getCompStr());\n      }\n\n      if (_this.vShowTaskInfoRes == 1) {\n        vTmpDiv = draw_utils_1.newNode(vTaskInfo, 'div', null, 'gTILine gTIr');\n        draw_utils_1.newNode(vTmpDiv, 'span', null, 'gTaskLabel', _this.vLangs[_this.vLang]['res'] + ': ');\n        draw_utils_1.newNode(vTmpDiv, 'span', null, 'gTaskText', pTask.getResource());\n      }\n\n      if (_this.vShowTaskInfoLink == 1 && pTask.getLink() != '') {\n        vTmpDiv = draw_utils_1.newNode(vTaskInfo, 'div', null, 'gTILine gTIl');\n        var vTmpNode = draw_utils_1.newNode(vTmpDiv, 'span', null, 'gTaskLabel');\n        vTmpNode = draw_utils_1.newNode(vTmpNode, 'a', null, 'gTaskText', _this.vLangs[_this.vLang]['moreinfo']);\n        vTmpNode.setAttribute('href', pTask.getLink());\n      }\n\n      if (_this.vShowTaskInfoNotes == 1) {\n        vTmpDiv = draw_utils_1.newNode(vTaskInfo, 'div', null, 'gTILine gTIn');\n        draw_utils_1.newNode(vTmpDiv, 'span', null, 'gTaskLabel', _this.vLangs[_this.vLang]['notes'] + ': ');\n        if (pTask.getNotes()) vTmpDiv.appendChild(pTask.getNotes());\n      }\n    }\n  };\n\n  var callback;\n\n  if (typeof templateStrOrFn === 'function') {\n    callback = function () {\n      var strOrPromise = templateStrOrFn(pTask);\n\n      if (!strOrPromise || typeof strOrPromise === 'string') {\n        setupTemplate(strOrPromise);\n      } else if (strOrPromise.then) {\n        setupTemplate(_this.vLangs[_this.vLang]['tooltipLoading'] || _this.vLangs['en']['tooltipLoading']);\n        return strOrPromise.then(setupTemplate);\n      }\n    };\n  } else {\n    setupTemplate(templateStrOrFn);\n  }\n\n  return {\n    component: vTaskInfoBox,\n    callback: callback\n  };\n};\n\nexports.AddTaskItem = function (value) {\n  var vExists = false;\n\n  for (var i = 0; i < this.vTaskList.length; i++) {\n    if (this.vTaskList[i].getID() == value.getID()) {\n      i = this.vTaskList.length;\n      vExists = true;\n    }\n  }\n\n  if (!vExists) {\n    this.vTaskList.push(value);\n    this.vProcessNeeded = true;\n  }\n};\n\nexports.AddTaskItemObject = function (object) {\n  if (!object.pGantt) {\n    object.pGantt = this;\n  }\n\n  return this.AddTaskItem(exports.TaskItemObject(object));\n};\n\nexports.RemoveTaskItem = function (pID) {\n  // simply mark the task for removal at this point - actually remove it next time we re-draw the chart\n  for (var i = 0; i < this.vTaskList.length; i++) {\n    if (this.vTaskList[i].getID() == pID) this.vTaskList[i].setToDelete(true);else if (this.vTaskList[i].getParent() == pID) this.RemoveTaskItem(this.vTaskList[i].getID());\n  }\n\n  this.vProcessNeeded = true;\n};\n\nexports.ClearTasks = function () {\n  var _this = this;\n\n  this.vTaskList.map(function (task) {\n    return _this.RemoveTaskItem(task.getID());\n  });\n  this.vProcessNeeded = true;\n}; // Recursively process task tree ... set min, max dates of parent tasks and identfy task level.\n\n\nexports.processRows = function (pList, pID, pRow, pLevel, pOpen, pUseSort, vDebug) {\n  if (vDebug === void 0) {\n    vDebug = false;\n  }\n\n  var vMinDate = null;\n  var vMaxDate = null;\n  var vMinPlanDate = null;\n  var vMaxPlanDate = null;\n  var vVisible = pOpen;\n  var vCurItem = null;\n  var vCompSum = 0;\n  var vMinSet = 0;\n  var vMaxSet = 0;\n  var vMinPlanSet = 0;\n  var vMaxPlanSet = 0;\n  var vNumKid = 0;\n  var vWeight = 0;\n  var vLevel = pLevel;\n  var vList = pList;\n  var vComb = false;\n  var i = 0;\n\n  for (i = 0; i < pList.length; i++) {\n    if (pList[i].getToDelete()) {\n      pList.splice(i, 1);\n      i--;\n    }\n\n    if (i >= 0 && pList[i].getID() == pID) vCurItem = pList[i];\n  }\n\n  for (i = 0; i < pList.length; i++) {\n    if (pList[i].getParent() == pID) {\n      vVisible = pOpen;\n      pList[i].setParItem(vCurItem);\n      pList[i].setVisible(vVisible);\n      if (vVisible == 1 && pList[i].getOpen() == 0) vVisible = 0;\n\n      if (pList[i].getMile() && pList[i].getParItem() && pList[i].getParItem().getGroup() == 2) {\n        //remove milestones owned by combined groups\n        pList.splice(i, 1);\n        i--;\n        continue;\n      }\n\n      pList[i].setLevel(vLevel);\n\n      if (pList[i].getGroup()) {\n        if (pList[i].getParItem() && pList[i].getParItem().getGroup() == 2) pList[i].setGroup(2);\n        exports.processRows(vList, pList[i].getID(), i, vLevel + 1, vVisible, 0);\n      }\n\n      if (pList[i].getStartVar() && (vMinSet == 0 || pList[i].getStartVar() < vMinDate)) {\n        vMinDate = pList[i].getStartVar();\n        vMinSet = 1;\n      }\n\n      if (pList[i].getEndVar() && (vMaxSet == 0 || pList[i].getEndVar() > vMaxDate)) {\n        vMaxDate = pList[i].getEndVar();\n        vMaxSet = 1;\n      }\n\n      if (vMinPlanSet == 0 || pList[i].getPlanStart() < vMinPlanDate) {\n        vMinPlanDate = pList[i].getPlanStart();\n        vMinPlanSet = 1;\n      }\n\n      if (vMaxPlanSet == 0 || pList[i].getPlanEnd() > vMaxPlanDate) {\n        vMaxPlanDate = pList[i].getPlanEnd();\n        vMaxPlanSet = 1;\n      }\n\n      vNumKid++;\n      vWeight += pList[i].getEnd() - pList[i].getStart() + 1;\n      vCompSum += pList[i].getCompVal() * (pList[i].getEnd() - pList[i].getStart() + 1);\n      pList[i].setSortIdx(i * pList.length);\n    }\n  }\n\n  if (pRow >= 0) {\n    if (pList[pRow].getGroupMinStart() != null && pList[pRow].getGroupMinStart() < vMinDate) {\n      vMinDate = pList[pRow].getGroupMinStart();\n    }\n\n    if (pList[pRow].getGroupMinEnd() != null && pList[pRow].getGroupMinEnd() > vMaxDate) {\n      vMaxDate = pList[pRow].getGroupMinEnd();\n    }\n\n    if (vMinDate) {\n      pList[pRow].setStart(vMinDate);\n    }\n\n    if (vMaxDate) {\n      pList[pRow].setEnd(vMaxDate);\n    }\n\n    if (pList[pRow].getGroupMinPlanStart() != null && pList[pRow].getGroupMinPlanStart() < vMinPlanDate) {\n      vMinPlanDate = pList[pRow].getGroupMinPlanStart();\n    }\n\n    if (pList[pRow].getGroupMinPlanEnd() != null && pList[pRow].getGroupMinPlanEnd() > vMaxPlanDate) {\n      vMaxPlanDate = pList[pRow].getGroupMinPlanEnd();\n    }\n\n    if (vMinPlanDate) {\n      pList[pRow].setPlanStart(vMinPlanDate);\n    }\n\n    if (vMaxPlanDate) {\n      pList[pRow].setPlanEnd(vMaxPlanDate);\n    }\n\n    pList[pRow].setNumKid(vNumKid);\n    pList[pRow].setWeight(vWeight);\n    pList[pRow].setCompVal(Math.ceil(vCompSum / vWeight));\n  }\n\n  if (pID == 0 && pUseSort == 1) {\n    var bd = void 0;\n\n    if (vDebug) {\n      bd = new Date();\n      console.info('before afterTasks', bd);\n    }\n\n    exports.sortTasks(pList, 0, 0);\n\n    if (vDebug) {\n      var ad = new Date();\n      console.info('after afterTasks', ad, ad.getTime() - bd.getTime());\n    }\n\n    pList.sort(function (a, b) {\n      return a.getSortIdx() - b.getSortIdx();\n    });\n  }\n\n  if (pID == 0 && pUseSort != 1) // Need to sort combined tasks regardless\n    {\n      for (i = 0; i < pList.length; i++) {\n        if (pList[i].getGroup() == 2) {\n          vComb = true;\n          var bd = void 0;\n\n          if (vDebug) {\n            bd = new Date();\n            console.info('before sortTasks', bd);\n          }\n\n          exports.sortTasks(pList, pList[i].getID(), pList[i].getSortIdx() + 1);\n\n          if (vDebug) {\n            var ad = new Date();\n            console.info('after sortTasks', ad, ad.getTime() - bd.getTime());\n          }\n        }\n      }\n\n      if (vComb == true) pList.sort(function (a, b) {\n        return a.getSortIdx() - b.getSortIdx();\n      });\n    }\n};","map":{"version":3,"sources":["C:/Users/Biblioteca/Desktop/Ing_Proyecto/SGPDRAT/webSGPDRAT/node_modules/jsgantt-improved/dist/src/task.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","defineProperty","exports","value","processRows","ClearTasks","RemoveTaskItem","AddTaskItemObject","AddTaskItem","createTaskInfo","TaskItem","TaskItemObject","sortTasks","taskLink","general_utils_1","require","draw_utils_1","date_utils_1","pRef","pWidth","pHeight","vWidth","vHeight","window","open","pList","pID","pIdx","sortIdx","sortArr","Array","getParent","push","sort","a","b","getStart","getTime","getEnd","getID","j","setSortIdx","object","pDataObject","internalProperties","forEach","property","pName","pStart","pEnd","pClass","pLink","pMile","pRes","pComp","pGroup","pParent","pOpen","pDepend","pCaption","pNotes","pGantt","pCost","pPlanStart","pPlanEnd","pDuration","pBarText","pPlanClass","vGantt","_id","document","createTextNode","data","vID","hashKey","vName","vStart","vEnd","vPlanStart","vPlanEnd","vGroupMinStart","vGroupMinEnd","vGroupMinPlanStart","vGroupMinPlanEnd","vClass","vPlanClass","vLink","vMile","parseInt","vRes","vComp","parseFloat","vCost","vGroup","vDataObject","vCompVal","parent","toString","vParent","vOpen","vDepend","vDependType","vCaption","vDuration","vBarText","vLevel","vNumKid","vWeight","vVisible","vSortIdx","vToDelete","x1","y1","x2","y2","vNotes","vParItem","vCellDiv","vBarDiv","vTaskDiv","vPlanTaskDiv","vListChildRow","vChildRow","vGroupSpan","createElement","className","innerHTML","stripUnwanted","Date","parseDateStr","getDateInputFormat","vDependStr","vDepList","split","k","toUpperCase","endsWith","substring","getOriginalID","getGantt","getName","getStartVar","date","vUnits","setMinutes","getMinutes","setMonth","getMonth","getEndVar","getPlanStart","getPlanClass","getPlanEnd","getCost","getGroupMinStart","getGroupMinEnd","getGroupMinPlanStart","getGroupMinPlanEnd","getClass","getLink","getMile","getDepend","getDataObject","getDepType","getCaption","getResource","getCompVal","getCompStr","getCompRestStr","getNotes","getSortIdx","getToDelete","getDuration","pFormat","pLang","calculateVDuration","start","end","hours","tmpPer","Math","round","getBarText","getGroup","getOpen","getLevel","getNumKids","getWeight","getStartX","getStartY","getEndX","getEndY","getVisible","getParItem","getCellDiv","getBarDiv","getTaskDiv","getPlanTaskDiv","getChildRow","getListChildRow","getGroupSpan","setName","setNotes","setClass","setPlanClass","setCost","setResource","setDuration","setDataObject","setStart","temp","isNaN","valueOf","setEnd","setPlanStart","setPlanEnd","setGroupMinStart","setGroupMinEnd","setLevel","pLevel","setNumKid","pNumKid","setWeight","pWeight","setCompVal","pCompVal","setComp","setStartX","pX","setStartY","pY","setEndX","setEndY","setOpen","setVisible","pVisible","pSortIdx","setToDelete","pToDelete","setParItem","pParItem","setCellDiv","pCellDiv","HTMLDivElement","setGroup","setBarText","setBarDiv","pDiv","setTaskDiv","setPlanTaskDiv","setChildRow","pRow","HTMLTableRowElement","setListChildRow","setGroupSpan","pSpan","HTMLSpanElement","getAllData","pGroupMinStart","pGroupMinEnd","pTask","templateStrOrFn","_this","vTmpDiv","vTaskInfoBox","createDocumentFragment","vTaskInfo","newNode","setupTemplate","template","allData_1","key","lang","internalPropertiesLang","vLangs","vLang","val","replace","vShowTaskInfoStartDate","formatDateStr","vDateTaskDisplayFormat","vShowTaskInfoEndDate","vShowTaskInfoDur","vFormat","vShowTaskInfoComp","vShowTaskInfoRes","vShowTaskInfoLink","vTmpNode","setAttribute","vShowTaskInfoNotes","appendChild","callback","strOrPromise","then","component","vExists","vTaskList","vProcessNeeded","map","task","pUseSort","vDebug","vMinDate","vMaxDate","vMinPlanDate","vMaxPlanDate","vCurItem","vCompSum","vMinSet","vMaxSet","vMinPlanSet","vMaxPlanSet","vList","vComb","splice","ceil","bd","console","info","ad"],"mappings":"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","sourcesContent":["\"use strict\";\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.processRows = exports.ClearTasks = exports.RemoveTaskItem = exports.AddTaskItemObject = exports.AddTaskItem = exports.createTaskInfo = exports.TaskItem = exports.TaskItemObject = exports.sortTasks = exports.taskLink = void 0;\r\nvar general_utils_1 = require(\"./utils/general_utils\");\r\nvar draw_utils_1 = require(\"./utils/draw_utils\");\r\nvar date_utils_1 = require(\"./utils/date_utils\");\r\n// function to open window to display task link\r\nexports.taskLink = function (pRef, pWidth, pHeight) {\r\n    var vWidth, vHeight;\r\n    if (pWidth)\r\n        vWidth = pWidth;\r\n    else\r\n        vWidth = 400;\r\n    if (pHeight)\r\n        vHeight = pHeight;\r\n    else\r\n        vHeight = 400;\r\n    window.open(pRef, 'newwin', 'height=' + vHeight + ',width=' + vWidth); // let OpenWindow = \r\n};\r\nexports.sortTasks = function (pList, pID, pIdx) {\r\n    if (pList.length < 2) {\r\n        return pIdx;\r\n    }\r\n    var sortIdx = pIdx;\r\n    var sortArr = new Array();\r\n    for (var i = 0; i < pList.length; i++) {\r\n        if (pList[i].getParent() == pID)\r\n            sortArr.push(pList[i]);\r\n    }\r\n    if (sortArr.length > 0) {\r\n        sortArr.sort(function (a, b) {\r\n            var i = a.getStart().getTime() - b.getStart().getTime();\r\n            if (i == 0)\r\n                i = a.getEnd().getTime() - b.getEnd().getTime();\r\n            if (i == 0)\r\n                return a.getID() - b.getID();\r\n            else\r\n                return i;\r\n        });\r\n    }\r\n    for (var j = 0; j < sortArr.length; j++) {\r\n        for (var i = 0; i < pList.length; i++) {\r\n            if (pList[i].getID() == sortArr[j].getID()) {\r\n                pList[i].setSortIdx(sortIdx++);\r\n                sortIdx = exports.sortTasks(pList, pList[i].getID(), sortIdx);\r\n            }\r\n        }\r\n    }\r\n    return sortIdx;\r\n};\r\nexports.TaskItemObject = function (object) {\r\n    var pDataObject = __assign({}, object);\r\n    general_utils_1.internalProperties.forEach(function (property) {\r\n        delete pDataObject[property];\r\n    });\r\n    return new exports.TaskItem(object.pID, object.pName, object.pStart, object.pEnd, object.pClass, object.pLink, object.pMile, object.pRes, object.pComp, object.pGroup, object.pParent, object.pOpen, object.pDepend, object.pCaption, object.pNotes, object.pGantt, object.pCost, object.pPlanStart, object.pPlanEnd, object.pDuration, object.pBarText, object, object.pPlanClass);\r\n};\r\nexports.TaskItem = function (pID, pName, pStart, pEnd, pClass, pLink, pMile, pRes, pComp, pGroup, pParent, pOpen, pDepend, pCaption, pNotes, pGantt, pCost, pPlanStart, pPlanEnd, pDuration, pBarText, pDataObject, pPlanClass) {\r\n    if (pCost === void 0) { pCost = null; }\r\n    if (pPlanStart === void 0) { pPlanStart = null; }\r\n    if (pPlanEnd === void 0) { pPlanEnd = null; }\r\n    if (pDuration === void 0) { pDuration = null; }\r\n    if (pBarText === void 0) { pBarText = null; }\r\n    if (pDataObject === void 0) { pDataObject = null; }\r\n    if (pPlanClass === void 0) { pPlanClass = null; }\r\n    var vGantt = pGantt ? pGantt : this;\r\n    var _id = document.createTextNode(pID).data;\r\n    var vID = general_utils_1.hashKey(document.createTextNode(pID).data);\r\n    var vName = document.createTextNode(pName).data;\r\n    var vStart = null;\r\n    var vEnd = null;\r\n    var vPlanStart = null;\r\n    var vPlanEnd = null;\r\n    var vGroupMinStart = null;\r\n    var vGroupMinEnd = null;\r\n    var vGroupMinPlanStart = null;\r\n    var vGroupMinPlanEnd = null;\r\n    var vClass = document.createTextNode(pClass).data;\r\n    var vPlanClass = document.createTextNode(pPlanClass).data;\r\n    var vLink = document.createTextNode(pLink).data;\r\n    var vMile = parseInt(document.createTextNode(pMile).data);\r\n    var vRes = document.createTextNode(pRes).data;\r\n    var vComp = parseFloat(document.createTextNode(pComp).data);\r\n    var vCost = parseInt(document.createTextNode(pCost).data);\r\n    var vGroup = parseInt(document.createTextNode(pGroup).data);\r\n    var vDataObject = pDataObject;\r\n    var vCompVal;\r\n    var parent = document.createTextNode(pParent).data;\r\n    if (parent && parent !== '0') {\r\n        parent = general_utils_1.hashKey(parent).toString();\r\n    }\r\n    var vParent = parent;\r\n    var vOpen = (vGroup == 2) ? 1 : parseInt(document.createTextNode(pOpen).data);\r\n    var vDepend = new Array();\r\n    var vDependType = new Array();\r\n    var vCaption = document.createTextNode(pCaption).data;\r\n    var vDuration = pDuration || '';\r\n    var vBarText = pBarText || '';\r\n    var vLevel = 0;\r\n    var vNumKid = 0;\r\n    var vWeight = 0;\r\n    var vVisible = 1;\r\n    var vSortIdx = 0;\r\n    var vToDelete = false;\r\n    var x1, y1, x2, y2;\r\n    var vNotes;\r\n    var vParItem = null;\r\n    var vCellDiv = null;\r\n    var vBarDiv = null;\r\n    var vTaskDiv = null;\r\n    var vPlanTaskDiv = null;\r\n    var vListChildRow = null;\r\n    var vChildRow = null;\r\n    var vGroupSpan = null;\r\n    vNotes = document.createElement('span');\r\n    vNotes.className = 'gTaskNotes';\r\n    if (pNotes != null) {\r\n        vNotes.innerHTML = pNotes;\r\n        general_utils_1.stripUnwanted(vNotes);\r\n    }\r\n    if (pStart != null && pStart != '') {\r\n        vStart = (pStart instanceof Date) ? pStart : date_utils_1.parseDateStr(document.createTextNode(pStart).data, vGantt.getDateInputFormat());\r\n        vGroupMinStart = vStart;\r\n    }\r\n    if (pEnd != null && pEnd != '') {\r\n        vEnd = (pEnd instanceof Date) ? pEnd : date_utils_1.parseDateStr(document.createTextNode(pEnd).data, vGantt.getDateInputFormat());\r\n        vGroupMinEnd = vEnd;\r\n    }\r\n    if (pPlanStart != null && pPlanStart != '') {\r\n        vPlanStart = (pPlanStart instanceof Date) ? pPlanStart : date_utils_1.parseDateStr(document.createTextNode(pPlanStart).data, vGantt.getDateInputFormat());\r\n        vGroupMinPlanStart = vPlanStart;\r\n    }\r\n    if (pPlanEnd != null && pPlanEnd != '') {\r\n        vPlanEnd = (pPlanEnd instanceof Date) ? pPlanEnd : date_utils_1.parseDateStr(document.createTextNode(pPlanEnd).data, vGantt.getDateInputFormat());\r\n        vGroupMinPlanEnd = vPlanEnd;\r\n    }\r\n    if (pDepend != null) {\r\n        var vDependStr = pDepend + '';\r\n        var vDepList = vDependStr.split(',');\r\n        var n = vDepList.length;\r\n        for (var k = 0; k < n; k++) {\r\n            if (vDepList[k].toUpperCase().endsWith('SS')) {\r\n                vDepend[k] = vDepList[k].substring(0, vDepList[k].length - 2);\r\n                vDependType[k] = 'SS';\r\n            }\r\n            else if (vDepList[k].toUpperCase().endsWith('FF')) {\r\n                vDepend[k] = vDepList[k].substring(0, vDepList[k].length - 2);\r\n                vDependType[k] = 'FF';\r\n            }\r\n            else if (vDepList[k].toUpperCase().endsWith('SF')) {\r\n                vDepend[k] = vDepList[k].substring(0, vDepList[k].length - 2);\r\n                vDependType[k] = 'SF';\r\n            }\r\n            else if (vDepList[k].toUpperCase().endsWith('FS')) {\r\n                vDepend[k] = vDepList[k].substring(0, vDepList[k].length - 2);\r\n                vDependType[k] = 'FS';\r\n            }\r\n            else {\r\n                vDepend[k] = vDepList[k];\r\n                vDependType[k] = 'FS';\r\n            }\r\n            if (vDepend[k]) {\r\n                vDepend[k] = general_utils_1.hashKey(vDepend[k]).toString();\r\n            }\r\n        }\r\n    }\r\n    this.getID = function () { return vID; };\r\n    this.getOriginalID = function () { return _id; };\r\n    this.getGantt = function () { return vGantt; };\r\n    this.getName = function () { return vName; };\r\n    this.getStart = function () {\r\n        if (vStart)\r\n            return vStart;\r\n        else if (vPlanStart)\r\n            return vPlanStart;\r\n        else\r\n            return new Date();\r\n    };\r\n    this.getStartVar = function () {\r\n        return vStart;\r\n    };\r\n    this.getEnd = function () {\r\n        if (vEnd)\r\n            return vEnd;\r\n        else if (vPlanEnd)\r\n            return vPlanEnd;\r\n        else if (vStart && vDuration) {\r\n            var date = new Date(vStart);\r\n            var vUnits = vDuration.split(' ');\r\n            var value = parseInt(vUnits[0]);\r\n            switch (vUnits[1]) {\r\n                case 'hour':\r\n                    date.setMinutes(date.getMinutes() + (value * 60));\r\n                    break;\r\n                case 'day':\r\n                    date.setMinutes(date.getMinutes() + (value * 60 * 24));\r\n                    break;\r\n                case 'week':\r\n                    date.setMinutes(date.getMinutes() + (value * 60 * 24 * 7));\r\n                    break;\r\n                case 'month':\r\n                    date.setMonth(date.getMonth() + (value));\r\n                    break;\r\n                case 'quarter':\r\n                    date.setMonth(date.getMonth() + (value * 3));\r\n                    break;\r\n            }\r\n            return date;\r\n        }\r\n        else\r\n            return new Date();\r\n    };\r\n    this.getEndVar = function () {\r\n        return vEnd;\r\n    };\r\n    this.getPlanStart = function () { return vPlanStart ? vPlanStart : vStart; };\r\n    this.getPlanClass = function () { return vPlanClass && vPlanClass !== \"null\" ? vPlanClass : vClass; };\r\n    this.getPlanEnd = function () { return vPlanEnd ? vPlanEnd : vEnd; };\r\n    this.getCost = function () { return vCost; };\r\n    this.getGroupMinStart = function () { return vGroupMinStart; };\r\n    this.getGroupMinEnd = function () { return vGroupMinEnd; };\r\n    this.getGroupMinPlanStart = function () { return vGroupMinPlanStart; };\r\n    this.getGroupMinPlanEnd = function () { return vGroupMinPlanEnd; };\r\n    this.getClass = function () { return vClass; };\r\n    this.getLink = function () { return vLink; };\r\n    this.getMile = function () { return vMile; };\r\n    this.getDepend = function () {\r\n        if (vDepend)\r\n            return vDepend;\r\n        else\r\n            return null;\r\n    };\r\n    this.getDataObject = function () { return vDataObject; };\r\n    this.getDepType = function () { if (vDependType)\r\n        return vDependType;\r\n    else\r\n        return null; };\r\n    this.getCaption = function () { if (vCaption)\r\n        return vCaption;\r\n    else\r\n        return ''; };\r\n    this.getResource = function () { if (vRes)\r\n        return vRes;\r\n    else\r\n        return '\\u00A0'; };\r\n    this.getCompVal = function () { if (vComp)\r\n        return vComp;\r\n    else if (vCompVal)\r\n        return vCompVal;\r\n    else\r\n        return 0; };\r\n    this.getCompStr = function () { if (vComp)\r\n        return vComp + '%';\r\n    else if (vCompVal)\r\n        return vCompVal + '%';\r\n    else\r\n        return ''; };\r\n    this.getCompRestStr = function () { if (vComp)\r\n        return (100 - vComp) + '%';\r\n    else if (vCompVal)\r\n        return (100 - vCompVal) + '%';\r\n    else\r\n        return ''; };\r\n    this.getNotes = function () { return vNotes; };\r\n    this.getSortIdx = function () { return vSortIdx; };\r\n    this.getToDelete = function () { return vToDelete; };\r\n    this.getDuration = function (pFormat, pLang) {\r\n        if (vMile) {\r\n            vDuration = '-';\r\n        }\r\n        else if (!vEnd && !vStart && vPlanStart && vPlanEnd) {\r\n            return calculateVDuration(pFormat, pLang, this.getPlanStart(), this.getPlanEnd());\r\n        }\r\n        else if (!vEnd && vDuration) {\r\n            return vDuration;\r\n        }\r\n        else {\r\n            vDuration = calculateVDuration(pFormat, pLang, this.getStart(), this.getEnd());\r\n        }\r\n        return vDuration;\r\n    };\r\n    function calculateVDuration(pFormat, pLang, start, end) {\r\n        var vDuration;\r\n        var vUnits = null;\r\n        switch (pFormat) {\r\n            case 'week':\r\n                vUnits = 'day';\r\n                break;\r\n            case 'month':\r\n                vUnits = 'week';\r\n                break;\r\n            case 'quarter':\r\n                vUnits = 'month';\r\n                break;\r\n            default:\r\n                vUnits = pFormat;\r\n                break;\r\n        }\r\n        // let vTaskEnd = new Date(this.getEnd().getTime());\r\n        // if ((vTaskEnd.getTime() - (vTaskEnd.getTimezoneOffset() * 60000)) % (86400000) == 0) {\r\n        //   vTaskEnd = new Date(vTaskEnd.getFullYear(), vTaskEnd.getMonth(), vTaskEnd.getDate() + 1, vTaskEnd.getHours(), vTaskEnd.getMinutes(), vTaskEnd.getSeconds());\r\n        // }\r\n        // let tmpPer = (getOffset(this.getStart(), vTaskEnd, 999, vUnits)) / 1000;\r\n        var hours = (end.getTime() - start.getTime()) / 1000 / 60 / 60;\r\n        var tmpPer;\r\n        switch (vUnits) {\r\n            case 'hour':\r\n                tmpPer = Math.round(hours);\r\n                vDuration = tmpPer + ' ' + ((tmpPer != 1) ? pLang['hrs'] : pLang['hr']);\r\n                break;\r\n            case 'day':\r\n                tmpPer = Math.round(hours / 24);\r\n                vDuration = tmpPer + ' ' + ((tmpPer != 1) ? pLang['dys'] : pLang['dy']);\r\n                break;\r\n            case 'week':\r\n                tmpPer = Math.round(hours / 24 / 7);\r\n                vDuration = tmpPer + ' ' + ((tmpPer != 1) ? pLang['wks'] : pLang['wk']);\r\n                break;\r\n            case 'month':\r\n                tmpPer = Math.round(hours / 24 / 7 / 4.35);\r\n                vDuration = tmpPer + ' ' + ((tmpPer != 1) ? pLang['mths'] : pLang['mth']);\r\n                break;\r\n            case 'quarter':\r\n                tmpPer = Math.round(hours / 24 / 7 / 13);\r\n                vDuration = tmpPer + ' ' + ((tmpPer != 1) ? pLang['qtrs'] : pLang['qtr']);\r\n                break;\r\n        }\r\n        return vDuration;\r\n    }\r\n    this.getBarText = function () { return vBarText; };\r\n    this.getParent = function () { return vParent; };\r\n    this.getGroup = function () { return vGroup; };\r\n    this.getOpen = function () { return vOpen; };\r\n    this.getLevel = function () { return vLevel; };\r\n    this.getNumKids = function () { return vNumKid; };\r\n    this.getWeight = function () { return vWeight; };\r\n    this.getStartX = function () { return x1; };\r\n    this.getStartY = function () { return y1; };\r\n    this.getEndX = function () { return x2; };\r\n    this.getEndY = function () { return y2; };\r\n    this.getVisible = function () { return vVisible; };\r\n    this.getParItem = function () { return vParItem; };\r\n    this.getCellDiv = function () { return vCellDiv; };\r\n    this.getBarDiv = function () { return vBarDiv; };\r\n    this.getTaskDiv = function () { return vTaskDiv; };\r\n    this.getPlanTaskDiv = function () { return vPlanTaskDiv; };\r\n    this.getChildRow = function () { return vChildRow; };\r\n    this.getListChildRow = function () { return vListChildRow; };\r\n    this.getGroupSpan = function () { return vGroupSpan; };\r\n    this.setName = function (pName) { vName = pName; };\r\n    this.setNotes = function (pNotes) { vNotes = pNotes; };\r\n    this.setClass = function (pClass) { vClass = pClass; };\r\n    this.setPlanClass = function (pPlanClass) { vPlanClass = pPlanClass; };\r\n    this.setCost = function (pCost) { vCost = pCost; };\r\n    this.setResource = function (pRes) { vRes = pRes; };\r\n    this.setDuration = function (pDuration) { vDuration = pDuration; };\r\n    this.setDataObject = function (pDataObject) { vDataObject = pDataObject; };\r\n    this.setStart = function (pStart) {\r\n        if (pStart instanceof Date) {\r\n            vStart = pStart;\r\n        }\r\n        else {\r\n            var temp = new Date(pStart);\r\n            if (temp instanceof Date && !isNaN(temp.valueOf())) {\r\n                vStart = temp;\r\n            }\r\n        }\r\n    };\r\n    this.setEnd = function (pEnd) {\r\n        if (pEnd instanceof Date) {\r\n            vEnd = pEnd;\r\n        }\r\n        else {\r\n            var temp = new Date(pEnd);\r\n            if (temp instanceof Date && !isNaN(temp.valueOf())) {\r\n                vEnd = temp;\r\n            }\r\n        }\r\n    };\r\n    this.setPlanStart = function (pPlanStart) {\r\n        if (pPlanStart instanceof Date)\r\n            vPlanStart = pPlanStart;\r\n        else\r\n            vPlanStart = new Date(pPlanStart);\r\n    };\r\n    this.setPlanEnd = function (pPlanEnd) {\r\n        if (pPlanEnd instanceof Date)\r\n            vPlanEnd = pPlanEnd;\r\n        else\r\n            vPlanEnd = new Date(pPlanEnd);\r\n    };\r\n    this.setGroupMinStart = function (pStart) { if (pStart instanceof Date)\r\n        vGroupMinStart = pStart; };\r\n    this.setGroupMinEnd = function (pEnd) { if (pEnd instanceof Date)\r\n        vGroupMinEnd = pEnd; };\r\n    this.setLevel = function (pLevel) { vLevel = parseInt(document.createTextNode(pLevel).data); };\r\n    this.setNumKid = function (pNumKid) { vNumKid = parseInt(document.createTextNode(pNumKid).data); };\r\n    this.setWeight = function (pWeight) { vWeight = parseInt(document.createTextNode(pWeight).data); };\r\n    this.setCompVal = function (pCompVal) { vCompVal = parseFloat(document.createTextNode(pCompVal).data); };\r\n    this.setComp = function (pComp) {\r\n        vComp = parseInt(document.createTextNode(pComp).data);\r\n    };\r\n    this.setStartX = function (pX) { x1 = parseInt(document.createTextNode(pX).data); };\r\n    this.setStartY = function (pY) { y1 = parseInt(document.createTextNode(pY).data); };\r\n    this.setEndX = function (pX) { x2 = parseInt(document.createTextNode(pX).data); };\r\n    this.setEndY = function (pY) { y2 = parseInt(document.createTextNode(pY).data); };\r\n    this.setOpen = function (pOpen) { vOpen = parseInt(document.createTextNode(pOpen).data); };\r\n    this.setVisible = function (pVisible) { vVisible = parseInt(document.createTextNode(pVisible).data); };\r\n    this.setSortIdx = function (pSortIdx) { vSortIdx = parseInt(document.createTextNode(pSortIdx).data); };\r\n    this.setToDelete = function (pToDelete) { if (pToDelete)\r\n        vToDelete = true;\r\n    else\r\n        vToDelete = false; };\r\n    this.setParItem = function (pParItem) { if (pParItem)\r\n        vParItem = pParItem; };\r\n    this.setCellDiv = function (pCellDiv) { if (typeof HTMLDivElement !== 'function' || pCellDiv instanceof HTMLDivElement)\r\n        vCellDiv = pCellDiv; }; //\"typeof HTMLDivElement !== 'function'\" to play nice with ie6 and 7\r\n    this.setGroup = function (pGroup) {\r\n        if (pGroup === true || pGroup === 'true') {\r\n            vGroup = 1;\r\n        }\r\n        else if (pGroup === false || pGroup === 'false') {\r\n            vGroup = 0;\r\n        }\r\n        else {\r\n            vGroup = parseInt(document.createTextNode(pGroup).data);\r\n        }\r\n    };\r\n    this.setBarText = function (pBarText) { if (pBarText)\r\n        vBarText = pBarText; };\r\n    this.setBarDiv = function (pDiv) { if (typeof HTMLDivElement !== 'function' || pDiv instanceof HTMLDivElement)\r\n        vBarDiv = pDiv; };\r\n    this.setTaskDiv = function (pDiv) { if (typeof HTMLDivElement !== 'function' || pDiv instanceof HTMLDivElement)\r\n        vTaskDiv = pDiv; };\r\n    this.setPlanTaskDiv = function (pDiv) { if (typeof HTMLDivElement !== 'function' || pDiv instanceof HTMLDivElement)\r\n        vPlanTaskDiv = pDiv; };\r\n    this.setChildRow = function (pRow) { if (typeof HTMLTableRowElement !== 'function' || pRow instanceof HTMLTableRowElement)\r\n        vChildRow = pRow; };\r\n    this.setListChildRow = function (pRow) { if (typeof HTMLTableRowElement !== 'function' || pRow instanceof HTMLTableRowElement)\r\n        vListChildRow = pRow; };\r\n    this.setGroupSpan = function (pSpan) { if (typeof HTMLSpanElement !== 'function' || pSpan instanceof HTMLSpanElement)\r\n        vGroupSpan = pSpan; };\r\n    this.getAllData = function () {\r\n        return {\r\n            pID: vID,\r\n            pName: vName,\r\n            pStart: vStart,\r\n            pEnd: vEnd,\r\n            pPlanStart: vPlanStart,\r\n            pPlanEnd: vPlanEnd,\r\n            pGroupMinStart: vGroupMinStart,\r\n            pGroupMinEnd: vGroupMinEnd,\r\n            pClass: vClass,\r\n            pLink: vLink,\r\n            pMile: vMile,\r\n            pRes: vRes,\r\n            pComp: vComp,\r\n            pCost: vCost,\r\n            pGroup: vGroup,\r\n            pDataObject: vDataObject,\r\n            pPlanClass: vPlanClass\r\n        };\r\n    };\r\n};\r\n/**\r\n * @param pTask\r\n * @param templateStrOrFn template string or function(task). In any case parameters in template string are substituted.\r\n *        If string - just a static template.\r\n *        If function(task): string - per task template. Can return null|undefined to fallback to default template.\r\n *        If function(task): Promise<string>) - async per task template. Tooltip will show 'Loading...' if promise is not yet complete.\r\n *          Otherwise returned template will be handled in the same manner as in other cases.\r\n */\r\nexports.createTaskInfo = function (pTask, templateStrOrFn) {\r\n    var _this = this;\r\n    if (templateStrOrFn === void 0) { templateStrOrFn = null; }\r\n    var vTmpDiv;\r\n    var vTaskInfoBox = document.createDocumentFragment();\r\n    var vTaskInfo = draw_utils_1.newNode(vTaskInfoBox, 'div', null, 'gTaskInfo');\r\n    var setupTemplate = function (template) {\r\n        vTaskInfo.innerHTML = \"\";\r\n        if (template) {\r\n            var allData_1 = pTask.getAllData();\r\n            general_utils_1.internalProperties.forEach(function (key) {\r\n                var lang;\r\n                if (general_utils_1.internalPropertiesLang[key]) {\r\n                    lang = _this.vLangs[_this.vLang][general_utils_1.internalPropertiesLang[key]];\r\n                }\r\n                if (!lang) {\r\n                    lang = key;\r\n                }\r\n                var val = allData_1[key];\r\n                template = template.replace(\"{{\" + key + \"}}\", val);\r\n                if (lang) {\r\n                    template = template.replace(\"{{Lang:\" + key + \"}}\", lang);\r\n                }\r\n                else {\r\n                    template = template.replace(\"{{Lang:\" + key + \"}}\", key);\r\n                }\r\n            });\r\n            draw_utils_1.newNode(vTaskInfo, 'span', null, 'gTtTemplate', template);\r\n        }\r\n        else {\r\n            draw_utils_1.newNode(vTaskInfo, 'span', null, 'gTtTitle', pTask.getName());\r\n            if (_this.vShowTaskInfoStartDate == 1) {\r\n                vTmpDiv = draw_utils_1.newNode(vTaskInfo, 'div', null, 'gTILine gTIsd');\r\n                draw_utils_1.newNode(vTmpDiv, 'span', null, 'gTaskLabel', _this.vLangs[_this.vLang]['startdate'] + ': ');\r\n                draw_utils_1.newNode(vTmpDiv, 'span', null, 'gTaskText', date_utils_1.formatDateStr(pTask.getStart(), _this.vDateTaskDisplayFormat, _this.vLangs[_this.vLang]));\r\n            }\r\n            if (_this.vShowTaskInfoEndDate == 1) {\r\n                vTmpDiv = draw_utils_1.newNode(vTaskInfo, 'div', null, 'gTILine gTIed');\r\n                draw_utils_1.newNode(vTmpDiv, 'span', null, 'gTaskLabel', _this.vLangs[_this.vLang]['enddate'] + ': ');\r\n                draw_utils_1.newNode(vTmpDiv, 'span', null, 'gTaskText', date_utils_1.formatDateStr(pTask.getEnd(), _this.vDateTaskDisplayFormat, _this.vLangs[_this.vLang]));\r\n            }\r\n            if (_this.vShowTaskInfoDur == 1 && !pTask.getMile()) {\r\n                vTmpDiv = draw_utils_1.newNode(vTaskInfo, 'div', null, 'gTILine gTId');\r\n                draw_utils_1.newNode(vTmpDiv, 'span', null, 'gTaskLabel', _this.vLangs[_this.vLang]['dur'] + ': ');\r\n                draw_utils_1.newNode(vTmpDiv, 'span', null, 'gTaskText', pTask.getDuration(_this.vFormat, _this.vLangs[_this.vLang]));\r\n            }\r\n            if (_this.vShowTaskInfoComp == 1) {\r\n                vTmpDiv = draw_utils_1.newNode(vTaskInfo, 'div', null, 'gTILine gTIc');\r\n                draw_utils_1.newNode(vTmpDiv, 'span', null, 'gTaskLabel', _this.vLangs[_this.vLang]['completion'] + ': ');\r\n                draw_utils_1.newNode(vTmpDiv, 'span', null, 'gTaskText', pTask.getCompStr());\r\n            }\r\n            if (_this.vShowTaskInfoRes == 1) {\r\n                vTmpDiv = draw_utils_1.newNode(vTaskInfo, 'div', null, 'gTILine gTIr');\r\n                draw_utils_1.newNode(vTmpDiv, 'span', null, 'gTaskLabel', _this.vLangs[_this.vLang]['res'] + ': ');\r\n                draw_utils_1.newNode(vTmpDiv, 'span', null, 'gTaskText', pTask.getResource());\r\n            }\r\n            if (_this.vShowTaskInfoLink == 1 && pTask.getLink() != '') {\r\n                vTmpDiv = draw_utils_1.newNode(vTaskInfo, 'div', null, 'gTILine gTIl');\r\n                var vTmpNode = draw_utils_1.newNode(vTmpDiv, 'span', null, 'gTaskLabel');\r\n                vTmpNode = draw_utils_1.newNode(vTmpNode, 'a', null, 'gTaskText', _this.vLangs[_this.vLang]['moreinfo']);\r\n                vTmpNode.setAttribute('href', pTask.getLink());\r\n            }\r\n            if (_this.vShowTaskInfoNotes == 1) {\r\n                vTmpDiv = draw_utils_1.newNode(vTaskInfo, 'div', null, 'gTILine gTIn');\r\n                draw_utils_1.newNode(vTmpDiv, 'span', null, 'gTaskLabel', _this.vLangs[_this.vLang]['notes'] + ': ');\r\n                if (pTask.getNotes())\r\n                    vTmpDiv.appendChild(pTask.getNotes());\r\n            }\r\n        }\r\n    };\r\n    var callback;\r\n    if (typeof templateStrOrFn === 'function') {\r\n        callback = function () {\r\n            var strOrPromise = templateStrOrFn(pTask);\r\n            if (!strOrPromise || typeof strOrPromise === 'string') {\r\n                setupTemplate(strOrPromise);\r\n            }\r\n            else if (strOrPromise.then) {\r\n                setupTemplate(_this.vLangs[_this.vLang]['tooltipLoading'] || _this.vLangs['en']['tooltipLoading']);\r\n                return strOrPromise.then(setupTemplate);\r\n            }\r\n        };\r\n    }\r\n    else {\r\n        setupTemplate(templateStrOrFn);\r\n    }\r\n    return { component: vTaskInfoBox, callback: callback };\r\n};\r\nexports.AddTaskItem = function (value) {\r\n    var vExists = false;\r\n    for (var i = 0; i < this.vTaskList.length; i++) {\r\n        if (this.vTaskList[i].getID() == value.getID()) {\r\n            i = this.vTaskList.length;\r\n            vExists = true;\r\n        }\r\n    }\r\n    if (!vExists) {\r\n        this.vTaskList.push(value);\r\n        this.vProcessNeeded = true;\r\n    }\r\n};\r\nexports.AddTaskItemObject = function (object) {\r\n    if (!object.pGantt) {\r\n        object.pGantt = this;\r\n    }\r\n    return this.AddTaskItem(exports.TaskItemObject(object));\r\n};\r\nexports.RemoveTaskItem = function (pID) {\r\n    // simply mark the task for removal at this point - actually remove it next time we re-draw the chart\r\n    for (var i = 0; i < this.vTaskList.length; i++) {\r\n        if (this.vTaskList[i].getID() == pID)\r\n            this.vTaskList[i].setToDelete(true);\r\n        else if (this.vTaskList[i].getParent() == pID)\r\n            this.RemoveTaskItem(this.vTaskList[i].getID());\r\n    }\r\n    this.vProcessNeeded = true;\r\n};\r\nexports.ClearTasks = function () {\r\n    var _this = this;\r\n    this.vTaskList.map(function (task) { return _this.RemoveTaskItem(task.getID()); });\r\n    this.vProcessNeeded = true;\r\n};\r\n// Recursively process task tree ... set min, max dates of parent tasks and identfy task level.\r\nexports.processRows = function (pList, pID, pRow, pLevel, pOpen, pUseSort, vDebug) {\r\n    if (vDebug === void 0) { vDebug = false; }\r\n    var vMinDate = null;\r\n    var vMaxDate = null;\r\n    var vMinPlanDate = null;\r\n    var vMaxPlanDate = null;\r\n    var vVisible = pOpen;\r\n    var vCurItem = null;\r\n    var vCompSum = 0;\r\n    var vMinSet = 0;\r\n    var vMaxSet = 0;\r\n    var vMinPlanSet = 0;\r\n    var vMaxPlanSet = 0;\r\n    var vNumKid = 0;\r\n    var vWeight = 0;\r\n    var vLevel = pLevel;\r\n    var vList = pList;\r\n    var vComb = false;\r\n    var i = 0;\r\n    for (i = 0; i < pList.length; i++) {\r\n        if (pList[i].getToDelete()) {\r\n            pList.splice(i, 1);\r\n            i--;\r\n        }\r\n        if (i >= 0 && pList[i].getID() == pID)\r\n            vCurItem = pList[i];\r\n    }\r\n    for (i = 0; i < pList.length; i++) {\r\n        if (pList[i].getParent() == pID) {\r\n            vVisible = pOpen;\r\n            pList[i].setParItem(vCurItem);\r\n            pList[i].setVisible(vVisible);\r\n            if (vVisible == 1 && pList[i].getOpen() == 0)\r\n                vVisible = 0;\r\n            if (pList[i].getMile() && pList[i].getParItem() && pList[i].getParItem().getGroup() == 2) { //remove milestones owned by combined groups\r\n                pList.splice(i, 1);\r\n                i--;\r\n                continue;\r\n            }\r\n            pList[i].setLevel(vLevel);\r\n            if (pList[i].getGroup()) {\r\n                if (pList[i].getParItem() && pList[i].getParItem().getGroup() == 2)\r\n                    pList[i].setGroup(2);\r\n                exports.processRows(vList, pList[i].getID(), i, vLevel + 1, vVisible, 0);\r\n            }\r\n            if (pList[i].getStartVar() && (vMinSet == 0 || pList[i].getStartVar() < vMinDate)) {\r\n                vMinDate = pList[i].getStartVar();\r\n                vMinSet = 1;\r\n            }\r\n            if (pList[i].getEndVar() && (vMaxSet == 0 || pList[i].getEndVar() > vMaxDate)) {\r\n                vMaxDate = pList[i].getEndVar();\r\n                vMaxSet = 1;\r\n            }\r\n            if (vMinPlanSet == 0 || pList[i].getPlanStart() < vMinPlanDate) {\r\n                vMinPlanDate = pList[i].getPlanStart();\r\n                vMinPlanSet = 1;\r\n            }\r\n            if (vMaxPlanSet == 0 || pList[i].getPlanEnd() > vMaxPlanDate) {\r\n                vMaxPlanDate = pList[i].getPlanEnd();\r\n                vMaxPlanSet = 1;\r\n            }\r\n            vNumKid++;\r\n            vWeight += pList[i].getEnd() - pList[i].getStart() + 1;\r\n            vCompSum += pList[i].getCompVal() * (pList[i].getEnd() - pList[i].getStart() + 1);\r\n            pList[i].setSortIdx(i * pList.length);\r\n        }\r\n    }\r\n    if (pRow >= 0) {\r\n        if (pList[pRow].getGroupMinStart() != null && pList[pRow].getGroupMinStart() < vMinDate) {\r\n            vMinDate = pList[pRow].getGroupMinStart();\r\n        }\r\n        if (pList[pRow].getGroupMinEnd() != null && pList[pRow].getGroupMinEnd() > vMaxDate) {\r\n            vMaxDate = pList[pRow].getGroupMinEnd();\r\n        }\r\n        if (vMinDate) {\r\n            pList[pRow].setStart(vMinDate);\r\n        }\r\n        if (vMaxDate) {\r\n            pList[pRow].setEnd(vMaxDate);\r\n        }\r\n        if (pList[pRow].getGroupMinPlanStart() != null && pList[pRow].getGroupMinPlanStart() < vMinPlanDate) {\r\n            vMinPlanDate = pList[pRow].getGroupMinPlanStart();\r\n        }\r\n        if (pList[pRow].getGroupMinPlanEnd() != null && pList[pRow].getGroupMinPlanEnd() > vMaxPlanDate) {\r\n            vMaxPlanDate = pList[pRow].getGroupMinPlanEnd();\r\n        }\r\n        if (vMinPlanDate) {\r\n            pList[pRow].setPlanStart(vMinPlanDate);\r\n        }\r\n        if (vMaxPlanDate) {\r\n            pList[pRow].setPlanEnd(vMaxPlanDate);\r\n        }\r\n        pList[pRow].setNumKid(vNumKid);\r\n        pList[pRow].setWeight(vWeight);\r\n        pList[pRow].setCompVal(Math.ceil(vCompSum / vWeight));\r\n    }\r\n    if (pID == 0 && pUseSort == 1) {\r\n        var bd = void 0;\r\n        if (vDebug) {\r\n            bd = new Date();\r\n            console.info('before afterTasks', bd);\r\n        }\r\n        exports.sortTasks(pList, 0, 0);\r\n        if (vDebug) {\r\n            var ad = new Date();\r\n            console.info('after afterTasks', ad, (ad.getTime() - bd.getTime()));\r\n        }\r\n        pList.sort(function (a, b) { return a.getSortIdx() - b.getSortIdx(); });\r\n    }\r\n    if (pID == 0 && pUseSort != 1) // Need to sort combined tasks regardless\r\n     {\r\n        for (i = 0; i < pList.length; i++) {\r\n            if (pList[i].getGroup() == 2) {\r\n                vComb = true;\r\n                var bd = void 0;\r\n                if (vDebug) {\r\n                    bd = new Date();\r\n                    console.info('before sortTasks', bd);\r\n                }\r\n                exports.sortTasks(pList, pList[i].getID(), pList[i].getSortIdx() + 1);\r\n                if (vDebug) {\r\n                    var ad = new Date();\r\n                    console.info('after sortTasks', ad, (ad.getTime() - bd.getTime()));\r\n                }\r\n            }\r\n        }\r\n        if (vComb == true)\r\n            pList.sort(function (a, b) { return a.getSortIdx() - b.getSortIdx(); });\r\n    }\r\n};\r\n"]},"metadata":{},"sourceType":"script"}